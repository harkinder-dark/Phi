{% extends 'base.html' %}
<!---->
{% block linkcss %}
<script src="{{ url_for('static', filename='js/jquery-3.7.0.min.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/sms.css') }}" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
{% endblock %}
<!---->
{% block search %}

{% endblock %}
<!---->
{% block basebody %}
<!--script type="text/javascript"  src="{{ url_for('static', filename='socketio.js') }}"></script>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
    let socket = io.connect('http://127.0.0.1:5000/chat');
    socket.on('connect', function() {
      /*socket.send('connected');*/
    });
    socket.on('message', function(data) {

      if (data.user === "{{ current_user._id }}") {
        $('#chatt').append(
          '<li class="clearfix">\
            <div class="message-data">\
              <div class="message my-message">' + data.msg +'</div>\
            </div>\
          </li>'
        );
      } else {
        $('#chatt').append(
          '<li class="clearfix">\
            <div class="message-data text-right">\
              <div class="message other-message float-right">' + data.msg +'</div>\
            </div>\
          </li>'
        );
      }
    });

    $('#btn').on('click', function() {
      let entries = $('#entries').val();
      if (entries.length) {
        socket.send({'msg': entries, 'user': "{{ current_user._id }}"});
      }
      $('#entries').val('');
      $('#entries').focus();
    });

  });
</script-->
<div class="container">
  <div class="row clearfix">
    <div class="col-lg-12">
        <div class="chat" h-90>
          <div class="chat-header clearfix">
            <div class="row">
              <div class="col-lg-6">
                <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
                  <img src="{{ url_for('profile.upload', filename=chatroom.friend.img) }}" alt="avatar">
                </a>
                <div class="chat-about">
                  <h6 class="m-b-0">{{ chatroom.friend.username }}</h6>
                  <small>Last seen: 2 hours ago</small>
                </div>
              </div>
              <!--div class="col-lg-6 hidden-sm text-right">
                <a href="javascript:void(0);" class="btn btn-outline-secondary"><i class="bi bi-camera"></i></a>
                <a href="javascript:void(0);" class="btn btn-outline-primary"><i class="bi bi-image"></i></a>
                <a href="javascript:void(0);" class="btn btn-outline-info"><i class="bi bi-gear"></i></a>
              </div-->
            </div>
          </div>
          <div class="chat-history">
            <ul class="m-b-0" id="chatt"></ul>
          </div>
          <div class="chat-message clearfix">
            <div class="input-group mb-0">
                <div class="input-group-prepend" id="btn">
                    <span class="input-group-text"><i class="bi bi-send"></i></span>
                </div>
                <input type="text" class="form-control" placeholder="Enter text here..." name="entries" id="entries" >                                    
            </div>
        </div>
    </div>
  </div>
</div>
<script type="text/javascript" >
  let username = `{{ current_user.username }}`;
  let room = `{{ room }}`;
</script>
<script type="text/javascript"  src="{{ url_for('static', filename='js/socketio.js') }}"></script>
{% endblock %}
