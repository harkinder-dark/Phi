{% extends 'base.html' %}
<!---->
{% block linkcss %}
<script src="{{ url_for('static', filename='js/jquery-3.7.0.min.js') }}"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/sms.css') }}" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
{% endblock %}
<!---->
{% block search %}

{% endblock %}
<!---->
{% block basebody %}
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
    let socket = io.connect('http://127.0.0.1:5000/me/chat');
    socket.on('connect', function() {
      socket.send('connected');
    });

    socket.on('message', function(data) {
      $('#chatt').append(
        $('<li class="clearfix">\
          <div class="message-data">\
            <img src="" alt="avatar"/>\
            <span class="message-data-time>+ data.msg.publish +, Today</span>\
          </div>\
          <div class="message my-message">' + data.msg + '</div>\
        </li>')
      );
    });

    $('#btn').on('click', function() {
      let entries = $('#entries').val();
      if (entries.length) {
        socket.send({'msg': entries, user: "{{ current_user.id }}"});
      }
      $('#entries').val('');
      $('#entries').focus();
    });

  });
</script>
<div class="container">
  <div class="row clearfix">
    <div class="col-lg-12">
        <div class="chat" h-90>
          <div class="chat-header clearfix">
            <div class="row">
              <div class="col-lg-6">
                <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
                  <img src="https://bootdey.com/img/Content/avatar/avatar2.png" alt="avatar">
                </a>
                <div class="chat-about">
                  <h6 class="m-b-0">Aiden Chavez</h6>
                  <small>Last seen: 2 hours ago</small>
                </div>
              </div>
              <div class="col-lg-6 hidden-sm text-right">
                <a href="javascript:void(0);" class="btn btn-outline-secondary"><i class="bi bi-camera"></i></a>
                <a href="javascript:void(0);" class="btn btn-outline-primary"><i class="bi bi-image"></i></a>
                <a href="javascript:void(0);" class="btn btn-outline-info"><i class="bi bi-gear"></i></a>
              </div>
            </div>
          </div>
          <div class="chat-history">
            <ul class="m-b-0" id="chatt">
              
              <li class="clearfix">
                <div class="message-data text-right">
                  <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="avatar" class="message-data-time float-right">
                  <span class="message-data-time float-right">10:10 AM, Today</span>
                  <span style="color: white;" class="clearfix">---</span>
                </div>
                <div class="message other-message float-right">
                  Hi Aiden, how are you? How is the project coming along?
                </div>
              </li>
              
              <li class="clearfix">
                <div class="message-data">
                  <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="avatar">
                  <span class="message-data-time">10:12 AM, Today</span>
                </div>
                <div class="message my-message">
                  Are we meeting today?
                </div>                                    
              </li>

            </ul>
          </div>
          <div class="chat-message clearfix">
            <div class="input-group mb-0">
                <div class="input-group-prepend" id="btn">
                    <span class="input-group-text"><i class="bi bi-send"></i></span>
                </div>
                <input type="text" class="form-control" placeholder="Enter text here..." name="entries" id="entries" >                                    
            </div>
        </div>
    </div>
  </div>
</div>
{% endblock %}
